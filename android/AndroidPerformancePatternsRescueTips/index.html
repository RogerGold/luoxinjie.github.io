<!DOCTYPE html>
<html>
   <head>
	<meta name="generator" content="Hugo 0.16" />
        <title>Luoxinjie's Blog</title> 		 
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
		
        <link rel="stylesheet" type="text/css" href="/static/css/style.css" />  
        <link href='http://fonts.useso.com/css?family=PT+Sans+Narrow' rel='stylesheet' type='text/css' />
		<link href='http://fonts.useso.com/css?family=Wire+One' rel='stylesheet' type='text/css' />	
		
		<script type='text/javascript' src='/static/js/jQuery_Migrate_v1.4.1.js'></script>
		<script>jQueryWP = jQuery;</script>
        <script type='text/javascript' src='/static/js/jQuery_v1.12.4.js'></script>
		<script type='text/javascript' src='/static/js/main.js'></script>
		<script type='text/javascript' src='/static/js/wp_embed_min.js'></script>
		
         
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/wiresareobsolete.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.3"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
			img.wp-smiley,
			img.emoji {
				display: inline !important;
				border: none !important;
				box-shadow: none !important;
				height: 1em !important;
				width: 1em !important;
				margin: 0 .07em !important;
				vertical-align: -0.1em !important;
				background: none !important;
				padding: 0 !important;
			}
		</style>
		 
		
		<style type="text/css">
		     ul li{list-style: none;float:left;}
			.blog-title a, .blog-description, .social-icons a { color: #ffffff; }
		
			.site-head { background-color: #303538; }
		                
			section a { color: #4a4a4a; }
		
			a:hover, body .blog-title a:hover, body .social-icons a:hover { color: #57A3E8; }
			.main-navigation a { color: #ffffff; }
		    .main-navigation a { color: #50585D; }
            .home .main-navigation a { color: #ffffff; }
        </style>

    </head>

    <body class="home blog paged paged-2"> 
           <header id="masthead" role="banner" class="site-head site-header">
                <nav id="site-navigation" class="main-navigation" role="navigation">
                     <div>
                            <h1 class="menu-toggle">
                                <a class="icon-bars" href="#">
                                 <span class="hidden">Menu</span>
                                 </a>
                            </h1>
                           <a class="skip-link screen-reader-text" href="#content">Skip to content</a>
                          <div class="menu-main-menu-container">
						   <ul id="menu-main-menu" class="menu">
								<li id="menu-item-878" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-878">
						           <a href="https://github.com/RogerGold" target="_blank"><img height="28" width="28" src="/media/github.png"  alt="github"/>
								   </a>
								</li>
								<li id="menu-item-878" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-878">
						           <a href="http://blog.csdn.net/luoxinjie" target="_blank"><img height="28" width="28" src="/media/scdn.png"  alt="csdn"/>
								   </a>								 
								</li>
                            </ul>
							</div>        
						</div>
				</nav>

				<div class="vertical-row">
					<div class="vertical">
					<div class="site-head-content inner">
                         <div>	
                             <img  src="/media/luoxinjie.png"  alt="photo"/>							 
					     </div>
					 <h1 class="blog-title"><a class="blog-logo" href='https://luoxinjie.github.io/' rel='home'>Luoxinjie</a></h1>
					 <h2 class="blog-description">A young people who like Android and Design.</h2>
					</div>
					</div>
				</div>
		   </header>
		   
	       <main id="content" class="content" role="main">
		   
		   
		   <article id="post-771" class="post-771 post type-post status-publish format-standard hentry category-android wpautop">
				<header class="post-header">
					<span class="post-meta">
						<span class="posted-on">
						
								<time class="entry-date published" datetime="2016-08-4T16:32:03+00:00">Aug 4, 2016
								</time>
							
						</span>
						<span class="byline"> by 
							<span class="author vcard">
								<a class="url fn n" href="https://github.com/RogerGold">
									Luoxinjie
								</a>
							</span>
						</span> 
						on 
						<a href="/android/" rel="category tag" target="_blank">
						Android
						</a>			
					</span>
							
						<h1 class="post-title">
							   
							      Android Performance Patterns: Rescue tips
						</h1>
         
				</header>
				<section class="post-content">
				    <p>
					    <img src="/media/AndroidPerformancePatterns.PNG"  alt="Android Performance Patterns.PNG"/>
					</p>
					<p>
					   Apps nowadays are all about fancy animations, complex transitions and custom views, and the user experience must be intuitive and similar as possible in any device. These patterns gonna help you build an app that’s smooth, responsive, and uses as little battery as possible, it covers micro-optimizations that can improve overall app performance.
					</p>
					<p>
					  <h4>Patterns to avoid bad performance</h4>
						1.Avoid blocking main Thread</br>
						2.Avoid unnecessary invalidations that may trigger a cascade of invalidations</br>
						3.Avoid Nested weights in LinearLayouts ( Cz each child needs to be measured twice)</br>
						4.Avoid Customs views not properly made</br>
						5.Avoid Creating Unnecessary Objects</br>
						6.Use Static Final For Constants (static 15%-20% faster)</br>
						7.Primitives (Integer vs Float 2x slower)</br>
						8.Avoid Internal Getters/Setters (direct field access 3x faster)</br>
						9.Use Enhanced For Loop Syntax</br>
						10.Consider Package Instead of Private Access with Private Inner Classes</br>
						11.Use Native Methods Carefully
					</p>
					<p>
					  <h4>Patterns for Custom views</h4>
						1.Keep It as Simple as Possible (KISS)</br>
						2.Use merge tag as root in your layout (avoid extra ViewGroups on inflation)</br>
						3.include tag (easy code reuse of common layouts)</br>
						4.Avoid unnecessary layouts</br>
						5.Don’t make allocations or heavy operations in OnDraw</br>
						6.Remove unnecessary calls to invalidate()</br>
						7.Consider creating your own ViewGroup</br>
						8.RecyclerView (replaces ListView and GridView)
				    </p>
					<p>
					 <h4>Patterns to avoid memory churn</h4>
						1.Don’t allocate a large amount of unnecessary objects:</br>
						2.Immutable classes: String</br>
						3.Autoboxing: Integer, Boolean..</br>
						4.Consider using Object Pools and caches to reduce churn</br>
						5.Be mindful of the overhead of enums (a single reference to an enum constant occupy 4 bytes)					 
					</p>
					<p>
					   <h4> Patterns to avoid memory leaks</h4>
						1.Don’t leak contexts in inner classes</br>
						2.Don’t leak views inside activity</br>
						3.Favor static inner classes over non static</br>
						4.Don’t use WeakHashmap as cache. Only the keys are WeakReference
					</p>
					<p>
					  <h4>Patterns for CPU</h4>
						1.Do not nest multi-pass layouts</br>
						2.Lazily compute complex data when needed</br>
						3.Cache heavy computational results for re-use</br>
						4.Consider RenderScript for performance</br>
						5.Keep work off of the main thread
					</p>
					<p>
					   <h4>Patterns to avoid Overdraw</h4>
							1.Simplify your drawables</br>
							2.Use nine patch with transparent parts</br>
							3.Caution with setting alpha in your views</br>
							4.Remove unused background from your views
					</p>
					<p>
					   <h4>Patterns for Bitmaps</h4>
						1.Decode bitmaps to the desire size: BitmapFactory.Options (inSampleSize, inDensity, inTargetDensity)</br>
						2.Load bitmaps in memory at the dimensions is going to be displayed</br>
						3.Don’t scale if you don’t need to (createScaledBitmap(btimap, int, int))</br>
						4.Use LRU cache
					</p>
					<p>
					<h4>Patterns for Services</h4>
						1.Do not keep running service unless it’s actively performing a job. Also be careful to stopservice it when its work is done</br>
						2.System prefers to always keep the service process in running. Then the RAM used by the service can’t be used by anything else or paged out</br>
						3.The best way to limit the lifespan of your service is to use an IntentService, which finishes itself as soon as it’s done handling the intent that started it</br>
						4.Leaving a service running when it’s not needed is one of the worst memory management mistakes an Android app can make
					</p>
					
					<p>
					   <h4>Patterns for Threads</h4>
						1.In a Thread run() method use Process.setThreadPriority() with THREAD_PRIORITY_BACKGROUND. This approach reduces resource competition between the Runnable object’s thread and the UI thread.</br>
						2.If you don’t set the thread to a lower priority this way, then the thread could still slow down your app because it operates at the same priority as the UI thread by default.</br>
						3.Stores the current Thread reference in your app, so that you want to interrupt the Thread later on. e.g: On network failure you can cancel that thread operation.
					</p>
					<p>
					   <h4>Patterns to avoid ANRs</h4>
						1.On UI thread do as little work as possible</br>
						2.If your app is doing work in the background in response to user input, show that progress is being made (such as with a ProgressBar in your UI).</br>
						3.Use performance tools such as Systrace and Traceview to determine bottlenecks in your app’s responsiveness.</br>
						4.If your application has a time-consuming initial setup phase, consider showing a launch screen or rendering the main view as quickly as possible, indicate that loading is in progress and fill the information asynchronously.
					</p>
					
					<p>
					   <h4>links & Resources:</h4>
					 <a href="https://medium.com/android-news/android-performance-patterns-rescue-tips-8c1e4c7cb1f0#.6jzw102e8" rel="category tag" target="_blank">android-performance-patterns</a>	</br>
					 <a href="http://developer.android.com/training/best-performance.html" rel="category tag" target="_blank">best-performance</a>	</br>
					 <a href="http://developer.android.com/training/articles/perf-tips.html" rel="category tag" target="_blank">perf-tips</a>	
					
					</p>
					<div class="clear">&nbsp;</div>
				</section>
		</article>
		  
		   
		   
		
		
	    <div id="secondary" class="widget-area" role="complementary">
				<div class="clear">&nbsp;</div>
	    </div>  
		
		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info inner">
				<section class="copyright">
					  <a href="https://github.com/RogerGold" target="_blank"><img height="28" width="28" src="/media/github.png"  alt="github"/>Contact Me</a>					
				</section>
			</div>
		</footer>
		
		</main>
		 <script type="text/javascript">
        
        var disqus_shortname = 'wiresareobsolete';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        
        </script>
	</body>
</html>